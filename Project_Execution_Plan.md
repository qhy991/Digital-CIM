# 项目执行计划：CIM-PQC 加速器

## 1. 目标与概述

本文档旨在为CIM-PQC加速器项目提供一个清晰、分阶段的执行计划。项目的最终目标是完成一个经过充分验证的、可用于后续物理实现（Tape-out）的混合信号（Mixed-Signal）芯片设计。

本项目包含两条并行且紧密关联的工作流：

1.  **模拟/全定制电路设计 (Analog/Custom Flow)**: 使用Cadence Virtuoso，在晶体管级别设计底层电路。
2.  **数字逻辑设计 (Digital Flow)**: 使用Verilog HDL，设计高层控制与数据通路逻辑。

本计划的核心是确保两条工作流协同推进，并在关键节点进行整合与验证。

## 2. 项目阶段与工作分解

我们将项目分为三个主要阶段：

### **阶段一：基础单元设计与验证 (当前阶段)**

此阶段的目标是确保所有最底层的电路和逻辑单元功能正确、性能达标。

**模拟电路团队 (`CIMPQC/`)**

1.  **原理图设计 (Schematic)**: 完成所有基础单元的原理图绘制，包括 `8T_cell`, `nand_gate`, `nor_gate`, `not_gate`, `csdrv` (感知放大器) 等。
2.  **电路仿真 (Simulation)**: 使用 **Spectre** 对每个单元进行详尽的仿真，验证其电气特性（DC、AC、瞬态响应），确保其满足设计指标（如速度、功耗、精度）。
3.  **版图设计 (Layout)**: 为通过仿真的单元绘制高质量的物理版图。
4.  **版图验证 (Verification)**: 对版图进行 **DRC** (设计规则检查) 和 **LVS** (版图-原理图一致性检查)，确保版图可制造且与原理图一致。
5.  **寄生参数提取 (PEX)**: 从验证后的版图中提取寄生参数，进行**后仿真（Post-layout Simulation）**，以获得最精确的性能数据。

**数字逻辑团队 (`ourwork/`)**

1.  **RTL编码**: 完成所有基础模块的Verilog编码，如 `accumulator`, `add`, `s_cla`, `gctrl` 等。
2.  **功能仿真 (Functional Simulation)**: 
    -   **核心任务**: 使用 `iverilog` 和 **GTKWave**，对每个模块进行**严格的功能验证**。
    -   **具体操作**: 为每个模块创建独立的Testbench，通过分析仿真波形，**逐一确认**其逻辑功能是否100%符合设计意图。
3.  **开发自检查Testbench**: 将现有的Testbench (`top_tb.v`) 升级为**自检查模式**。让Testbench自动比较模块的实际输出和预期输出，并直接报告`SUCCESS`或`FAILURE`。这是实现高效回归测试的关键。

**阶段一交付成果 (Milestone 1):**
-   一套经过充分仿真和版图验证的**定制单元库**。
-   一套经过严格功能验证的**Verilog RTL模块**。

---

### **阶段二：子系统集成与混合信号验证**

此阶段的目标是将基础单元集成为更大的子系统（如 `cim_array`, `cim_bank`），并首次进行模拟-数字协同仿真。

**模拟电路团队**

1.  **集成与布局**: 将 `8T_cell` 集成为 `cim_row` 和 `cim_array`。将 `cim_array` 和 `csdrv` 等周边电路集成为 `cim_bank`。完成这些子系统的原理图和版图设计。
2.  **子系统仿真与验证**: 对 `cim_bank` 级别的模块进行仿真和版图验证。

**数字逻辑团队**

1.  **逻辑综合 (Logic Synthesis)**: 使用 `tcl/` 目录下的脚本，在 **Synopsys DC** 或 **Cadence Genus** 中对 `cim_array_ctrl` 等控制器模块进行综合，生成门级网表。
2.  **后综合仿真 (Post-synthesis Simulation)**: 使用相同的Testbench，仿真综合后生成的门级网表，确保其功能与RTL代码一致。

**混合信号验证团队 (关键步骤)**

1.  **建立混合信号仿真环境**: 在Cadence Virtuoso环境中，搭建一个**模拟-数字协同仿真 (Mixed-Signal Simulation)** 平台。
2.  **协同仿真**: 
    -   **仿真对象**: 模拟部分的 `cim_bank` (原理图或提取的网表) 与数字部分的 `cim_array_ctrl` (Verilog RTL代码) 。
    -   **目标**: 验证数字控制器能否正确驱动模拟电路，以及模拟电路的输出能否被数字部分正确解读。这是验证整个CIM理念是否成立的**第一个关键节点**。

**阶段二交付成果 (Milestone 2):**
-   一个经过混合信号验证的、功能正确的 `cim_bank` 子系统。

---

### **阶段三：顶层集成与全芯片验证**

此阶段的目标是完成整个芯片的集成，并进行最终的签核（Sign-off）验证。

1.  **顶层集成**: 在Virtuoso中，将所有的 `cim_bank` 和顶层的数字逻辑（综合后的门级网表）进行拼接，完成顶层原理图和版图的连接与布局布线。
2.  **全芯片验证**: 
    -   运行**全芯片LVS和DRC**。
    -   进行**静态时序分析 (Static Timing Analysis, STA)**，确保数字部分在所有工艺角（Process Corners）下都能满足时序要求。
    -   进行**功耗分析 (Power Analysis)**。
    -   如果可能，进行简化的**顶层混合信号仿真**。
3.  **生成GDSII文件**: 完成所有验证后，生成用于提交给芯片代工厂（Foundry）进行生产的最终版图文件（GDSII格式）。

**阶段三交付成果 (Milestone 3):**
-   一个通过所有签核验证的、**可供生产（Tape-out Ready）的GDSII文件**。

## 3. 当前的下一步行动

根据当前状态，**最紧急、最重要的任务**是完成**阶段一**的验证工作：

-   **对于数字部分**: **立即开始分析 `top_tb.vcd` 波形**，逐一确认每个模块的逻辑功能是否正确。同时，开始将Testbench升级为自检查模式。
-   **对于模拟部分**: 确保每个基础单元都完成了从原理图到后仿真的完整流程，并有详细的性能报告。

只有在所有基础单元都100%可靠的前提下，才能进入后续的集成阶段，否则后期的问题将难以定位和修复。
